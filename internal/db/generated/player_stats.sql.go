// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: player_stats.sql

package db

import (
	"context"
)

const createPlayerStats = `-- name: CreatePlayerStats :one
INSERT INTO player_stats (
    id, player_id, server_id, games_played, wins, losses, total_score,
    total_play_time, last_login, total_kills, total_deaths, friendly_fire_kills, highest_score
) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
RETURNING id, player_id, server_id, games_played, wins, losses, total_score, total_play_time, last_login, total_kills, total_deaths, friendly_fire_kills, highest_score
`

type CreatePlayerStatsParams struct {
	ID                string
	PlayerID          int64
	ServerID          int64
	GamesPlayed       *int64
	Wins              *int64
	Losses            *int64
	TotalScore        *int64
	TotalPlayTime     *int64
	LastLogin         *string
	TotalKills        *int64
	TotalDeaths       *int64
	FriendlyFireKills *int64
	HighestScore      *int64
}

func (q *Queries) CreatePlayerStats(ctx context.Context, arg CreatePlayerStatsParams) (PlayerStat, error) {
	row := q.db.QueryRowContext(ctx, createPlayerStats,
		arg.ID,
		arg.PlayerID,
		arg.ServerID,
		arg.GamesPlayed,
		arg.Wins,
		arg.Losses,
		arg.TotalScore,
		arg.TotalPlayTime,
		arg.LastLogin,
		arg.TotalKills,
		arg.TotalDeaths,
		arg.FriendlyFireKills,
		arg.HighestScore,
	)
	var i PlayerStat
	err := row.Scan(
		&i.ID,
		&i.PlayerID,
		&i.ServerID,
		&i.GamesPlayed,
		&i.Wins,
		&i.Losses,
		&i.TotalScore,
		&i.TotalPlayTime,
		&i.LastLogin,
		&i.TotalKills,
		&i.TotalDeaths,
		&i.FriendlyFireKills,
		&i.HighestScore,
	)
	return i, err
}

const deletePlayerStats = `-- name: DeletePlayerStats :exec
DELETE FROM player_stats WHERE id = ?
`

func (q *Queries) DeletePlayerStats(ctx context.Context, id string) error {
	_, err := q.db.ExecContext(ctx, deletePlayerStats, id)
	return err
}

const getPlayerStatsByID = `-- name: GetPlayerStatsByID :one
SELECT id, player_id, server_id, games_played, wins, losses, total_score, total_play_time, last_login, total_kills, total_deaths, friendly_fire_kills, highest_score FROM player_stats WHERE id = ?
`

func (q *Queries) GetPlayerStatsByID(ctx context.Context, id string) (PlayerStat, error) {
	row := q.db.QueryRowContext(ctx, getPlayerStatsByID, id)
	var i PlayerStat
	err := row.Scan(
		&i.ID,
		&i.PlayerID,
		&i.ServerID,
		&i.GamesPlayed,
		&i.Wins,
		&i.Losses,
		&i.TotalScore,
		&i.TotalPlayTime,
		&i.LastLogin,
		&i.TotalKills,
		&i.TotalDeaths,
		&i.FriendlyFireKills,
		&i.HighestScore,
	)
	return i, err
}

const getPlayerStatsByPlayerID = `-- name: GetPlayerStatsByPlayerID :one
SELECT id, player_id, server_id, games_played, wins, losses, total_score, total_play_time, last_login, total_kills, total_deaths, friendly_fire_kills, highest_score FROM player_stats WHERE player_id = ?
`

func (q *Queries) GetPlayerStatsByPlayerID(ctx context.Context, playerID int64) (PlayerStat, error) {
	row := q.db.QueryRowContext(ctx, getPlayerStatsByPlayerID, playerID)
	var i PlayerStat
	err := row.Scan(
		&i.ID,
		&i.PlayerID,
		&i.ServerID,
		&i.GamesPlayed,
		&i.Wins,
		&i.Losses,
		&i.TotalScore,
		&i.TotalPlayTime,
		&i.LastLogin,
		&i.TotalKills,
		&i.TotalDeaths,
		&i.FriendlyFireKills,
		&i.HighestScore,
	)
	return i, err
}

const getTopPlayersByScorePerMin = `-- name: GetTopPlayersByScorePerMin :many
SELECT ps.id, ps.player_id, ps.server_id, ps.games_played, ps.wins, ps.losses, ps.total_score, ps.total_play_time, ps.last_login, ps.total_kills, ps.total_deaths, ps.friendly_fire_kills, ps.highest_score, p.name as player_name
FROM player_stats ps
JOIN players p ON ps.player_id = p.id
WHERE ps.server_id = ?
AND ps.total_play_time > 0
ORDER BY (CAST(ps.total_score AS REAL) / (ps.total_play_time / 60.0)) DESC
LIMIT 3
`

type GetTopPlayersByScorePerMinRow struct {
	ID                string
	PlayerID          int64
	ServerID          int64
	GamesPlayed       *int64
	Wins              *int64
	Losses            *int64
	TotalScore        *int64
	TotalPlayTime     *int64
	LastLogin         *string
	TotalKills        *int64
	TotalDeaths       *int64
	FriendlyFireKills *int64
	HighestScore      *int64
	PlayerName        string
}

func (q *Queries) GetTopPlayersByScorePerMin(ctx context.Context, serverID int64) ([]GetTopPlayersByScorePerMinRow, error) {
	rows, err := q.db.QueryContext(ctx, getTopPlayersByScorePerMin, serverID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetTopPlayersByScorePerMinRow
	for rows.Next() {
		var i GetTopPlayersByScorePerMinRow
		if err := rows.Scan(
			&i.ID,
			&i.PlayerID,
			&i.ServerID,
			&i.GamesPlayed,
			&i.Wins,
			&i.Losses,
			&i.TotalScore,
			&i.TotalPlayTime,
			&i.LastLogin,
			&i.TotalKills,
			&i.TotalDeaths,
			&i.FriendlyFireKills,
			&i.HighestScore,
			&i.PlayerName,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updatePlayerStats = `-- name: UpdatePlayerStats :one
UPDATE player_stats
SET games_played = ?, wins = ?, losses = ?, total_score = ?, total_play_time = ?,
    last_login = ?, total_kills = ?, total_deaths = ?, friendly_fire_kills = ?, highest_score = ?
WHERE id = ?
RETURNING id, player_id, server_id, games_played, wins, losses, total_score, total_play_time, last_login, total_kills, total_deaths, friendly_fire_kills, highest_score
`

type UpdatePlayerStatsParams struct {
	GamesPlayed       *int64
	Wins              *int64
	Losses            *int64
	TotalScore        *int64
	TotalPlayTime     *int64
	LastLogin         *string
	TotalKills        *int64
	TotalDeaths       *int64
	FriendlyFireKills *int64
	HighestScore      *int64
	ID                string
}

func (q *Queries) UpdatePlayerStats(ctx context.Context, arg UpdatePlayerStatsParams) (PlayerStat, error) {
	row := q.db.QueryRowContext(ctx, updatePlayerStats,
		arg.GamesPlayed,
		arg.Wins,
		arg.Losses,
		arg.TotalScore,
		arg.TotalPlayTime,
		arg.LastLogin,
		arg.TotalKills,
		arg.TotalDeaths,
		arg.FriendlyFireKills,
		arg.HighestScore,
		arg.ID,
	)
	var i PlayerStat
	err := row.Scan(
		&i.ID,
		&i.PlayerID,
		&i.ServerID,
		&i.GamesPlayed,
		&i.Wins,
		&i.Losses,
		&i.TotalScore,
		&i.TotalPlayTime,
		&i.LastLogin,
		&i.TotalKills,
		&i.TotalDeaths,
		&i.FriendlyFireKills,
		&i.HighestScore,
	)
	return i, err
}
