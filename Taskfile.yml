version: "3"
tasks:
  goreleaser-dev:
    desc: Run goreleaser in snapshot (dev) mode
    cmds:
      - goreleaser release --snapshot --clean
  goreleaser-release:
    desc: Run goreleaser for a full release
    cmds:
      - goreleaser release --clean
  build:
    desc: Build all Go binaries
    cmds:
      - go build ./...\
  dev:
    desc: run app with defaults
    cmds:
      - go run main.go serve
  test:
    desc: Run all Go tests
    cmds:
      - go test ./...
  fmt:
    desc: Run gofmt on all Go files
    cmds:
      - gofmt -w .
  superuser:
    desc: Create an initial superuser account
    cmds:
      - go run . superuser create test@example.com password123
  clean:
    desc: Remove built binaries
    cmds:
      - go clean
  reset:
    desc: Remove pb_data directory to reset database
    cmds:
      - powershell -Command "if (Test-Path pb_data) { Remove-Item -Recurse -Force pb_data; Write-Host 'pb_data removed' } else { Write-Host 'pb_data does not exist' }"
